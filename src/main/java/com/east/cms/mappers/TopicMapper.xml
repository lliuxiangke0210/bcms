<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.east.cms.dao.TopicMapper">
  
  <sql id="Topic_Column_List">
    id, title, keyword, status, recommend, content, summary, publishDate, createDate, 
    author, cname, channelPicId, channelId, userId
  </sql>
 
  <select id="find" resultType="com.east.cms.model.Topic" >
	 select
	<include refid="Topic_Column_List"/>	
	 from topic  where 1=1
	<if test=" status != null">
	   and status=#{status}
	</if>
	<if test="title != null ">
	   and title like  '%#{title}%'
	</if>	
	<if test="userId != null and userId > 0 "  >
	   and userId=#{userId}
	</if>
	<if test="channelId != null and channelId > 0 " >
	   and channelId=#{channelId}
	</if>
  </select>
  
  <select id="searchTopicByKeyword" parameterType="java.lang.String" resultType="com.east.cms.model.Topic" >
   select 
  <include refid="Topic_Column_List"/>	
   from  topic where status=1 and keyword like '%#{keyword}%'
  </select>
  
  <select id="searchTopic" parameterType="java.lang.String" resultType="com.east.cms.model.Topic" >
  select 
  <include refid="Topic_Column_List"/>		
  from topic where status=1 and (title like '%#{con}%' or content like '%#{con}%' or summary like  '%#{con}%')		
  </select>

  <select id="findRecommendTopic" parameterType="java.lang.Integer" resultType="com.east.cms.model.Topic">
  select 
  <include refid="Topic_Column_List"/>
  from topic where status=1 and recommend=1
  <if test=" channelId != null and channelId != 0">
     and channelId=#{channelId}
  </if>
  </select>
 
  <select id="listTopicByChannelAndNumber" resultType="com.east.cms.model.Topic" >
  select 
  <include refid="Topic_Column_List"/>
  from topic where status=1 and channelId=#{channelId} order by publishDate desc limit 0 ,#{num}
  </select>
  
  <select id="listTopicsByChannel"  resultType="com.east.cms.model.Topic" >
   select 
   <include refid="Topic_Column_List"/>
   from topic where channelId=#{channelId} 
  </select>
  
  <select id="loadLastedTopicByColumn" parameterType="java.lang.Integer" resultType="com.east.cms.model.Topic" >
  select  
  <include refid="Topic_Column_List"/>
  from topic where status=1 and channelId=#{channelId} order by publishDate desc limit 0,1
  </select>
 
</mapper>